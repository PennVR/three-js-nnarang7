//random gradients for fireworks
var gradient = [0xFFFFFF, 0xF8F7FA, 0xF2F0F5, 0xECE8F1, 0xE6E1EC, 0xE0DAE8, 0xDAD2E3, 0xD4CBDF, 0xCEC4DA, 0xC8BCD5, 0xC2B5D1, 0xBCAECC, 0xB6A6C8, 0xB09FC3, 0xAA98BF, 0xA490BA, 0x9E89B6, 0x9882B1, 0x917AAC, 0x8B73A8, 0x856BA3, 0x7F649F, 0x795D9A, 0x735596, 0x6D4E91, 0x67478D, 0x613F88, 0x5B3883, 0x55317F, 0x4F297A, 0x492276, 0x431B71, 0x3D136D, 0x370C68, 0x310564, 0x340766, 0x370A68, 0x3A0D6B, 0x3D106D, 0x401370, 0x431672, 0x461974, 0x491C77, 0x4C1E79, 0x4F217C, 0x53247E, 0x562781, 0x592A83, 0x5C2D85, 0x5F3088, 0x62338A, 0x65358D, 0x68388F, 0x6B3B92, 0x6E3E94, 0x714196, 0x754499, 0x78479B, 0x7B4A9E, 0x7E4CA0, 0x814FA3, 0x8452A5, 0x8755A7, 0x8A58AA, 0x8D5BAC, 0x905EAF, 0x9361B1, 0x9764B4, 0x9667B1, 0x966BAF, 0x966EAC, 0x9672AA, 0x9676A7, 0x9679A5, 0x967DA3, 0x9681A0, 0x96849E, 0x96889B, 0x968C99, 0x958F96, 0x959394, 0x959692, 0x959A8F, 0x959E8D, 0x95A18A, 0x95A588, 0x95A985, 0x95AC83, 0x95B081, 0x95B47E, 0x94B77C, 0x94BB79, 0x94BE77, 0x94C274, 0x94C672, 0x94C970, 0x94CD6D, 0x94D16B, 0x94D468, 0x94D866, 0x94DC64, 0x8FDC60, 0x8BDD5D, 0x86DE5A, 0x82DF57, 0x7DE054, 0x79E151, 0x74E24E, 0x70E34B, 0x6BE448, 0x67E545, 0x62E642, 0x5EE63F, 0x59E73C, 0x55E839, 0x50E936, 0x4CEA33, 0x47EB30, 0x43EC2D, 0x3EED2A, 0x3AEE27, 0x35EF24, 0x31F021, 0x2CF01E, 0x28F11B, 0x23F218, 0x1FF315, 0x1AF412, 0x16F50F, 0x11F60C, 0x0DF709, 0x08F806, 0x04F903, 0x00FA00, 0x05F203, 0x0AEB07, 0x0FE40B, 0x14DD0F, 0x19D513, 0x1ECE17, 0x24C71B, 0x29C01F, 0x2EB823, 0x33B127, 0x38AA2B, 0x3DA32F, 0x429B33, 0x489437, 0x4D8D3B, 0x52863F, 0x577E42, 0x5C7746, 0x61704A, 0x67694E, 0x6C6152, 0x715A56, 0x76535A, 0x7B4C5E, 0x804462, 0x853D66, 0x8B366A, 0x902F6E, 0x952772, 0x9A2076, 0x9F197A, 0xA4127E, 0xAA0B82, 0xAA1180, 0xAB187E, 0xAC1E7C, 0xAD257A, 0xAE2C78, 0xAF3277, 0xB03975, 0xB14073, 0xB24671, 0xB34D6F, 0xB4546E, 0xB55A6C, 0xB6616A, 0xB76768, 0xB86E66, 0xB97564, 0xB97B63, 0xBA8261, 0xBB895F, 0xBC8F5D, 0xBD965B, 0xBE9D5A, 0xBFA358, 0xC0AA56, 0xC1B054, 0xC2B752, 0xC3BE50, 0xC4C44F, 0xC5CB4D, 0xC6D24B, 0xC7D849, 0xC8DF47, 0xC9E646]

function createHeightMap(w, h, p) {
	var heightMap = [];
	heightMap[w * h - 1] = 0.0;
	var scale_factor = 15;

	//making random noise map
	for (var i = 0; i < w * h; i++) {
		var x = i % w;
		var y = i / w;
		var z = Math.random() * w;

		var noise_val = noise(x, y, z, p, w);
		var noise_transformed = noise_val * scale_factor;
		if (heightMap[i - 1] < heightMap[i]) {
			heightMap[i] = noise_transformed - (heightMap[i] - heightMap[i - 1]) / 2;
		} else {
			heightMap[i] = noise_transformed;
		}
	}
	return heightMap;
}

function generateStars(numStars) {
	//mapping stars to random coordinates in the sky
	var starMap = [];
	for (var i = 0; i < numStars; i++) {
		var x, y, z;

		var x = THREE.Math.randInt(-600, 500);
		var y = THREE.Math.randInt(-200, 600);
		var z = THREE.Math.randInt(-250, 350);			

		while (y < 150) {
			y = Math.random() * 500 - 300;
		}

		starMap.push(x, y, z);
	}
	return starMap;
}

function shouldMakeFirework() {
	//10% chance of creating a firework
	return Math.random() <= 0.1;
}

function getRandomColor() {
	var index = Math.floor(Math.random() * gradient.length);
	return gradient[index];
}